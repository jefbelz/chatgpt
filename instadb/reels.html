<!DOCTYPE html>
<html lang="en" class="dark" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lilia Database</title>

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
       <link href="https://cdn.datatables.net/v/bs5/jq-3.7.0/jszip-3.10.1/dt-1.13.8/b-2.4.2/b-colvis-2.4.2/b-html5-2.4.2/b-print-2.4.2/cr-1.7.0/fc-4.3.0/fh-3.4.0/kt-2.11.0/r-2.5.0/sc-2.3.0/sp-2.2.0/sl-1.7.0/sr-1.3.0/datatables.min.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/v/bs5/jq-3.7.0/jszip-3.10.1/dt-1.13.8/b-2.4.2/b-colvis-2.4.2/b-html5-2.4.2/b-print-2.4.2/cr-1.7.0/fc-4.3.0/fh-3.4.0/kt-2.11.0/r-2.5.0/sc-2.3.0/sp-2.2.0/sl-1.7.0/sr-1.3.0/datatables.min.js"></script>    <style type="text/css" class="init"></style>
       <script type="text/javascript" class="init"></script>
    <style>
        #logo {
            margin-right: 10px; /* Adjust the margin as needed */
        }
    /* Add this style to prevent column wrapping */
    .dataTables tbody td {
      white-space: nowrap;
    }
    </style>

    </style>
</head>
<body>
<table >
    <tr>
        <td><img id="logo" src="logolilia.png" alt="Logo"> </td>
        <td><br><br><h2>Reels parsed database</h2></td>
    </tr>
</table>
<table id="example" class="display compact table-striped dataTable" >
    <thead>
    <tr>
        <th>User</th>
        <th >URL</th>
        <th>Likes</th>
        <th>Views</th>
        <th>Comments</th>
        <th>Taken at</th>

        <th>Analysis</th>
        <th>Transcription</th>
        <th>Text On video</th>
        <th >Caption</th>


        <th>Video</th>
        <th>Duration</th>

    </tr>
    </thead>
    <tbody>
    <!-- Table rows will be dynamically populated by DataTables -->
    </tbody>
</table>
<script>
 var jsonData; // Variable to store JSON data

 function loadJSON() {
     var resultDiv = document.getElementById('result');
     var xhr = new XMLHttpRequest();

     xhr.onreadystatechange = function() {
         if (xhr.readyState === 4) {
             if (xhr.status === 200) {
                 try {

                     var jsonData = JSON.parse(xhr.responseText);
                     console.log(jsonData)


                     $('#example').DataTable({
                         data: jsonData,
                         columns: [{
                                 data: 'username',
                                 searchable: true,
                                 width: '4%',

                             },
                             {
                                 data: 'url',
                                 searchable: true,
                                 render: function(data, type, row) {
                                     return '<a href="' + data + '" target="_blank">reel</a>';
                                 },
                                 width: '4%'
                             },

                               {
                                 data: 'like_count',
                                 searchable: true,
                                 width: '4%',
                                 render: function(data, type, row) {
                                     return data.toLocaleString(); // Example: 1,234
                                 }
                             },
                             {
                                 data: 'view_count',
                                 searchable: true,
                                 width: '4%',
                                 render: function(data, type, row) {
                                     return data.toLocaleString(); // Example: 1,234
                                 }
                             },
                             {
                                 data: 'comment_count',
                                 searchable: true,
                                 width: '4%',
                                 render: function(data, type, row) {
                                     return data.toLocaleString(); // Example: 1,234
                                 }
                             },
                             {
                                 data: 'taken_at',
                                 searchable: true,
                                 width: '4%',
                                 render: function(data, type, row) {
                                     // Convert the ISO date string to a Date object
                                     var date = new Date(data);
                                     var formattedDate = date.toLocaleString('en-RU', {
                                         year: '2-digit',
                                         month: '2-digit',
                                         day: '2-digit',
                                         hour: '2-digit',
                                         minute: '2-digit'
                                     });

                                     return formattedDate;
                                 }
                             },{
                                 data: 'video_analysis',
                                 searchable: false,
                                 width: '16%',
                                 render: function(data, type, row) {
                                     var formattedText = data.replace(/\n/g, '<br>');
                                     return formattedText;
                                 }
                             },
                             {
                                 data: 'video_transcription',
                                 searchable: false,
                                 width: '17%',
                                 render: function(data, type, row) {
                                     var formattedText = data.replace(/\n/g, '<br>');
                                     return formattedText;
                                 }
                             },
                             {
                                 data: 'text_on_video',
                                 width: '15%',
                                 render: function(data, type, row) {
                                     var formattedText = data.replace(/\n/g, '<br>');
                                     return formattedText;
                                 }
                             },
                             {
                                 data: 'text',
                                 searchable: true,
                                 width: '17%',
                                 render: function(data, type, row) {
                                     var formattedText = data.replace(/\n/g, '<br>');
                                     return formattedText;
                                 }
                             },



                             {
                                 data: 'video_url',
                                 searchable: false,
                                 render: function(data, type, row) {
                                     return '<a href="' + data + '" target="_blank">Video</a>';
                                 },
                                 width: '4%'
                             },
                             {
                                 data: 'video_duration',
                                 searchable: false,
                                 width: '4%'
                             },
                         ],
                         lengthMenu: [
                             [20, 50, -1],
                             [20, 50, 'All']
                         ],
                         scrollCollapse: true,
                         scrollY: '50vh',
                         scrollX: true,
                          scrollX: '50vh',
                          searchPanes: {
                                threshold: 0.5
                            },
                          columnDefs: [
                              {
                                    searchPanes: {
                                        show: true
                                    },
                                    targets: [0]
                                }
                            ],

                         responsive: true,
                         dom: 'PB<"top"l>rt<"bottom"ip><"clear">',
                         fixedColumns: true,
                         fixedHeader: true,
                         rowReorder: true,
                         colReorder: true,
                         select: true,
                         buttons: ['copy', 'csv', 'excel', 'pdf', 'print', 'createState', 'savedStates']
                     });
                     resultDiv.innerHTML = "<pre>" + JSON.stringify(jsonData, null, 2) + "</pre>";
                 } catch (error) {
                     resultDiv.innerHTML = "Error parsing JSON file: " + error.message;
                 }
             } else {
                 resultDiv.innerHTML = "Error loading JSON file. Status: " + xhr.status;
             }
         }
     };
     xhr.open('GET', 'reels.json', true);
     xhr.send();
}

loadJSON();

</script>
</body>
</html>
